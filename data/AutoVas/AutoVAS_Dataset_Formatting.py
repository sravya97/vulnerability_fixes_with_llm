import os
import pandas as pd
import csv

# Path to your directory containing the files
directory_path = 'AutoVAS/dataset/source/NVD'

# Initialize lists to store data
vulnerable_codes = []
patched_codes = []
# Loop through files in the directory
data_map = {}
index = 0
input_data = []
output_data = []
for filename in os.listdir(directory_path):
    if "PATCHED" in filename:
        # Find the corresponding vulnerable file
        vulnerable_filename = filename.replace('PATCHED', 'VULN')
        # Read and store the patched code
        with open(os.path.join(directory_path, filename), 'r') as patched_file:
            patched_code = patched_file.read()
        with open(os.path.join(directory_path, vulnerable_filename), 'r') as file:
            vulnerable_code = file.read()
        if vulnerable_code != None and patched_code != None:
            vulnerable_codes.append(vulnerable_code)
            patched_codes.append(patched_code)
            input_data.append(vulnerable_code)
            output_data.append(patched_code)

with open('data.csv', 'w', newline='') as file:
    writer = csv.writer(file)
    writer.writerow(["Vulnerable Code", "Patched Code"])
    for input_row, output_row in zip(input_data, output_data):
        writer.writerow([input_row, output_row])




